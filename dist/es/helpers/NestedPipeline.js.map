{"version":3,"file":"NestedPipeline.js","sources":["../../../src/helpers/NestedPipeline.js"],"sourcesContent":["import React from 'react'\nimport useWillPipe from '../hooks/use-will-pipe'\nimport Pipeline from './Pipeline'\nimport TriggerPipelineOnCallback from '../triggers/TriggerPipelineOnCallback'\n\nexport default function NestedPipeline ({ children }) {\n  const callbackRef = React.useRef(null)\n\n  const updateCallbackRef = (callback) => {\n    callbackRef.current = callback\n  }\n\n  useWillPipe((payload) => new Promise((resolve, reject) => {\n    Promise.resolve(callbackRef.current(payload))\n      .then((p = {}) => {\n        resolve({ ...payload, ...p })\n      })\n      .catch((err) => {\n        reject(err)\n      })\n  }))\n\n  return (\n    <Pipeline>\n      <TriggerPipelineOnCallback callback={updateCallbackRef} />\n      {children}\n    </Pipeline>\n  )\n}\n"],"names":["NestedPipeline","children","callbackRef","React","useRef","updateCallbackRef","callback","current","useWillPipe","payload","Promise","resolve","reject","then","p","catch","err"],"mappings":";;;;;;;;;AAKe,SAASA,cAAT,CAAuC,IAAA,EAAA;AAAA,EAAZC,IAAAA,QAAY,QAAZA,QAAY,CAAA;AACpD,EAAA,IAAMC,WAAW,GAAGC,KAAK,CAACC,MAAN,CAAa,IAAb,CAApB,CAAA;;AAEA,EAAA,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,QAAD,EAAc;AACtCJ,IAAAA,WAAW,CAACK,OAAZ,GAAsBD,QAAtB,CAAA;AACD,GAFD,CAAA;;AAIAE,EAAAA,WAAW,CAAC,UAACC,OAAD,EAAA;AAAA,IAAA,OAAa,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACxDF,MAAAA,OAAO,CAACC,OAAR,CAAgBT,WAAW,CAACK,OAAZ,CAAoBE,OAApB,CAAhB,CACGI,CAAAA,IADH,CACQ,YAAY;AAAA,QAAXC,IAAAA,CAAW,uEAAP,EAAO,CAAA;AAChBH,QAAAA,OAAO,CAAA,aAAA,CAAA,aAAA,CAAA,EAAA,EAAMF,OAAN,CAAA,EAAkBK,CAAlB,CAAP,CAAA,CAAA;AACD,OAHH,CAIGC,CAAAA,KAJH,CAIS,UAACC,GAAD,EAAS;AACdJ,QAAAA,MAAM,CAACI,GAAD,CAAN,CAAA;AACD,OANH,CAAA,CAAA;AAOD,KARwB,CAAb,CAAA;AAAA,GAAD,CAAX,CAAA;AAUA,EAAA,oBACE,KAAC,CAAA,aAAA,CAAA,QAAD,EACE,IAAA,eAAA,KAAA,CAAA,aAAA,CAAC,yBAAD,EAAA;AAA2B,IAAA,QAAQ,EAAEX,iBAAAA;AAArC,GADF,CAAA,EAEGJ,QAFH,CADF,CAAA;AAMD;;;;"}