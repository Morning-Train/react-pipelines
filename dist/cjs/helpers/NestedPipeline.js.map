{"version":3,"file":"NestedPipeline.js","sources":["../../../src/helpers/NestedPipeline.js"],"sourcesContent":["import React from 'react'\nimport useWillPipe from '../hooks/use-will-pipe'\nimport Pipeline from './Pipeline'\nimport TriggerPipelineOnCallback from '../triggers/TriggerPipelineOnCallback'\n\nexport default function NestedPipeline ({ children }) {\n  const callbackRef = React.useRef(null)\n\n  const updateCallbackRef = (callback) => {\n    callbackRef.current = callback\n  }\n\n  useWillPipe((payload) => new Promise((resolve, reject) => {\n    Promise.resolve(callbackRef.current(payload))\n      .then((p = {}) => {\n        resolve({ ...payload, ...p })\n      })\n      .catch((err) => {\n        reject(err)\n      })\n  }))\n\n  return (\n    <Pipeline>\n      <TriggerPipelineOnCallback callback={updateCallbackRef} />\n      {children}\n    </Pipeline>\n  )\n}\n"],"names":["NestedPipeline","children","callbackRef","React","useRef","updateCallbackRef","callback","current","useWillPipe","payload","Promise","resolve","reject","then","p","catch","err"],"mappings":";;;;;;;;;;;;AAKe,SAASA,cAAT,OAAuC;AAAA,MAAZC,QAAY,QAAZA,QAAY;AACpD,MAAMC,WAAW,GAAGC,yBAAK,CAACC,MAAN,CAAa,IAAb,CAApB;;AAEA,MAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,QAAD,EAAc;AACtCJ,IAAAA,WAAW,CAACK,OAAZ,GAAsBD,QAAtB;AACD,GAFD;;AAIAE,EAAAA,WAAW,CAAC,UAACC,OAAD;AAAA,WAAa,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACxDF,MAAAA,OAAO,CAACC,OAAR,CAAgBT,WAAW,CAACK,OAAZ,CAAoBE,OAApB,CAAhB,EACGI,IADH,CACQ,YAAY;AAAA,YAAXC,CAAW,uEAAP,EAAO;AAChBH,QAAAA,OAAO,qFAAMF,OAAN,GAAkBK,CAAlB,EAAP;AACD,OAHH,EAIGC,KAJH,CAIS,UAACC,GAAD,EAAS;AACdJ,QAAAA,MAAM,CAACI,GAAD,CAAN;AACD,OANH;AAOD,KARwB,CAAb;AAAA,GAAD,CAAX;AAUA,sBACEb,wCAAC,QAAD,qBACEA,wCAAC,yBAAD;AAA2B,IAAA,QAAQ,EAAEE;AAArC,IADF,EAEGJ,QAFH,CADF;AAMD;;;;"}