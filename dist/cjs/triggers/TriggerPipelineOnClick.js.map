{"version":3,"file":"TriggerPipelineOnClick.js","sources":["../../../src/triggers/TriggerPipelineOnClick.js"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport usePipeline from '../hooks/use-pipeline'\n\nfunction TriggerPipelineOnClick ({ children, onlyTriggerWhenIdle = true }) {\n  const pipeline = usePipeline()\n\n  const isCurrentlyPipingRef = React.useRef(false)\n\n  const handleClick = (e) => {\n    if (e) {\n      if (typeof e.preventDefault === 'function') {\n        e.preventDefault()\n      }\n      if (typeof e.stopPropagation === 'function') {\n        e.stopPropagation()\n      }\n      if (typeof e.persist === 'function') {\n        e.persist()\n      }\n    }\n\n    if (onlyTriggerWhenIdle === true && isCurrentlyPipingRef.current === true) {\n      return\n    }\n\n    isCurrentlyPipingRef.current = true\n\n    const payload = {\n      clickEvent: e\n    }\n\n    pipeline.trigger(payload)\n      .then((p) => {\n        isCurrentlyPipingRef.current = false\n        return p\n      })\n      .catch((err) => {\n        isCurrentlyPipingRef.current = false\n      })\n  }\n\n  return React.Children.map(children, (child) => (\n    React.cloneElement(child, { onClick: handleClick })\n  ))\n}\n\nTriggerPipelineOnClick.propTypes = {\n  onlyTriggerWhenIdle: PropTypes.bool\n}\n\nexport default TriggerPipelineOnClick\n"],"names":["TriggerPipelineOnClick","children","onlyTriggerWhenIdle","pipeline","usePipeline","isCurrentlyPipingRef","React","useRef","handleClick","e","preventDefault","stopPropagation","persist","current","payload","clickEvent","trigger","then","p","catch","err","Children","map","child","cloneElement","onClick","propTypes","PropTypes","bool"],"mappings":";;;;;;;;;;;AAIA,SAASA,sBAAT,OAA2E;AAAA,MAAxCC,QAAwC,QAAxCA,QAAwC;AAAA,mCAA9BC,mBAA8B;AAAA,MAA9BA,mBAA8B,sCAAR,IAAQ;AACzE,MAAMC,QAAQ,GAAGC,WAAW,EAA5B;AAEA,MAAMC,oBAAoB,GAAGC,yBAAK,CAACC,MAAN,CAAa,KAAb,CAA7B;;AAEA,MAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,CAAD,EAAO;AACzB,QAAIA,CAAJ,EAAO;AACL,UAAI,OAAOA,CAAC,CAACC,cAAT,KAA4B,UAAhC,EAA4C;AAC1CD,QAAAA,CAAC,CAACC,cAAF;AACD;;AACD,UAAI,OAAOD,CAAC,CAACE,eAAT,KAA6B,UAAjC,EAA6C;AAC3CF,QAAAA,CAAC,CAACE,eAAF;AACD;;AACD,UAAI,OAAOF,CAAC,CAACG,OAAT,KAAqB,UAAzB,EAAqC;AACnCH,QAAAA,CAAC,CAACG,OAAF;AACD;AACF;;AAED,QAAIV,mBAAmB,KAAK,IAAxB,IAAgCG,oBAAoB,CAACQ,OAArB,KAAiC,IAArE,EAA2E;AACzE;AACD;;AAEDR,IAAAA,oBAAoB,CAACQ,OAArB,GAA+B,IAA/B;AAEA,QAAMC,OAAO,GAAG;AACdC,MAAAA,UAAU,EAAEN;AADE,KAAhB;AAIAN,IAAAA,QAAQ,CAACa,OAAT,CAAiBF,OAAjB,EACGG,IADH,CACQ,UAACC,CAAD,EAAO;AACXb,MAAAA,oBAAoB,CAACQ,OAArB,GAA+B,KAA/B;AACA,aAAOK,CAAP;AACD,KAJH,EAKGC,KALH,CAKS,UAACC,GAAD,EAAS;AACdf,MAAAA,oBAAoB,CAACQ,OAArB,GAA+B,KAA/B;AACD,KAPH;AAQD,GA/BD;;AAiCA,SAAOP,yBAAK,CAACe,QAAN,CAAeC,GAAf,CAAmBrB,QAAnB,EAA6B,UAACsB,KAAD;AAAA,wBAClCjB,yBAAK,CAACkB,YAAN,CAAmBD,KAAnB,EAA0B;AAAEE,MAAAA,OAAO,EAAEjB;AAAX,KAA1B,CADkC;AAAA,GAA7B,CAAP;AAGD;;AAEDR,sBAAsB,CAAC0B,SAAvB,GAAmC;AACjCxB,EAAAA,mBAAmB,EAAEyB,6BAAS,CAACC;AADE,CAAnC;;;;"}