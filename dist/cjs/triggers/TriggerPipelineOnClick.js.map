{"version":3,"file":"TriggerPipelineOnClick.js","sources":["../../../src/triggers/TriggerPipelineOnClick.js"],"sourcesContent":["import React from 'react'\nimport PropTypes from 'prop-types'\nimport usePipeline from '../hooks/use-pipeline'\n\nfunction TriggerPipelineOnClick ({ children, onlyTriggerWhenIdle = true, preventDefault = true }) {\n  const pipeline = usePipeline()\n\n  const isCurrentlyPipingRef = React.useRef(false)\n\n  const handleClick = (e) => {\n    if (e && preventDefault === true) {\n      if (typeof e.preventDefault === 'function') {\n        e.preventDefault()\n      }\n      if (typeof e.stopPropagation === 'function') {\n        e.stopPropagation()\n      }\n      if (typeof e.persist === 'function') {\n        e.persist()\n      }\n    }\n\n    if (onlyTriggerWhenIdle === true && isCurrentlyPipingRef.current === true) {\n      return\n    }\n\n    isCurrentlyPipingRef.current = true\n\n    const payload = {\n      clickEvent: e\n    }\n\n    pipeline.trigger(payload)\n      .then((p) => {\n        isCurrentlyPipingRef.current = false\n        return p\n      })\n      .catch((err) => {\n        isCurrentlyPipingRef.current = false\n      })\n  }\n\n  return React.Children.map(children, (child) => (\n    React.cloneElement(child, { onClick: handleClick })\n  ))\n}\n\nTriggerPipelineOnClick.propTypes = {\n  onlyTriggerWhenIdle: PropTypes.bool,\n  preventDefault: PropTypes.bool\n}\n\nexport default TriggerPipelineOnClick\n"],"names":["TriggerPipelineOnClick","children","onlyTriggerWhenIdle","preventDefault","pipeline","usePipeline","isCurrentlyPipingRef","React","useRef","handleClick","e","stopPropagation","persist","current","payload","clickEvent","trigger","then","p","catch","err","Children","map","child","cloneElement","onClick","propTypes","PropTypes","bool"],"mappings":";;;;;;;;;;;AAIA,SAASA,sBAAT,OAAkG;AAAA,MAA/DC,QAA+D,QAA/DA,QAA+D;AAAA,mCAArDC,mBAAqD;AAAA,MAArDA,mBAAqD,sCAA/B,IAA+B;AAAA,iCAAzBC,cAAyB;AAAA,MAAzBA,cAAyB,oCAAR,IAAQ;AAChG,MAAMC,QAAQ,GAAGC,WAAW,EAA5B;AAEA,MAAMC,oBAAoB,GAAGC,yBAAK,CAACC,MAAN,CAAa,KAAb,CAA7B;;AAEA,MAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,CAAD,EAAO;AACzB,QAAIA,CAAC,IAAIP,cAAc,KAAK,IAA5B,EAAkC;AAChC,UAAI,OAAOO,CAAC,CAACP,cAAT,KAA4B,UAAhC,EAA4C;AAC1CO,QAAAA,CAAC,CAACP,cAAF;AACD;;AACD,UAAI,OAAOO,CAAC,CAACC,eAAT,KAA6B,UAAjC,EAA6C;AAC3CD,QAAAA,CAAC,CAACC,eAAF;AACD;;AACD,UAAI,OAAOD,CAAC,CAACE,OAAT,KAAqB,UAAzB,EAAqC;AACnCF,QAAAA,CAAC,CAACE,OAAF;AACD;AACF;;AAED,QAAIV,mBAAmB,KAAK,IAAxB,IAAgCI,oBAAoB,CAACO,OAArB,KAAiC,IAArE,EAA2E;AACzE;AACD;;AAEDP,IAAAA,oBAAoB,CAACO,OAArB,GAA+B,IAA/B;AAEA,QAAMC,OAAO,GAAG;AACdC,MAAAA,UAAU,EAAEL;AADE,KAAhB;AAIAN,IAAAA,QAAQ,CAACY,OAAT,CAAiBF,OAAjB,EACGG,IADH,CACQ,UAACC,CAAD,EAAO;AACXZ,MAAAA,oBAAoB,CAACO,OAArB,GAA+B,KAA/B;AACA,aAAOK,CAAP;AACD,KAJH,EAKGC,KALH,CAKS,UAACC,GAAD,EAAS;AACdd,MAAAA,oBAAoB,CAACO,OAArB,GAA+B,KAA/B;AACD,KAPH;AAQD,GA/BD;;AAiCA,SAAON,yBAAK,CAACc,QAAN,CAAeC,GAAf,CAAmBrB,QAAnB,EAA6B,UAACsB,KAAD;AAAA,wBAClChB,yBAAK,CAACiB,YAAN,CAAmBD,KAAnB,EAA0B;AAAEE,MAAAA,OAAO,EAAEhB;AAAX,KAA1B,CADkC;AAAA,GAA7B,CAAP;AAGD;;AAEDT,sBAAsB,CAAC0B,SAAvB,GAAmC;AACjCxB,EAAAA,mBAAmB,EAAEyB,6BAAS,CAACC,IADE;AAEjCzB,EAAAA,cAAc,EAAEwB,6BAAS,CAACC;AAFO,CAAnC;;;;"}